# 要件定義書

## はじめに

「こつこつ」は、React Native + Expoで構築するiPhone向け習慣トラッキングアプリである。ユーザーが最大10個の習慣項目を登録し、タップすることで累積回数を記録できるシンプルな単一画面アプリケーションである。本プロジェクトはモバイル開発の学習を目的とする。ルーティングは使用しない。

## 用語集

- **アプリ**: 「こつこつ」習慣トラッキングアプリケーション
- **習慣項目**: ユーザーが追跡したい習慣を表すデータ。名前と累積カウントを持つ
- **習慣リスト**: トップページに表示される習慣項目の一覧（最大10件）
- **累積カウント**: 習慣項目がタップされた合計回数
- **作成モーダル**: 習慣項目の新規作成に使用するオーバーレイUI
- **編集モーダル**: 習慣項目の編集・削除に使用するオーバーレイUI
- **共有シート**: OSネイティブの共有機能（iOS Share Sheet）
- **ローカルストレージ**: デバイス上のAsyncStorageによるデータ永続化領域

## 要件

### 要件1: 習慣リストの表示

**ユーザーストーリー:** ユーザーとして、トップページで自分の習慣項目一覧を確認したい。進捗を一目で把握できるようにするため。

#### 受け入れ基準

1. WHEN アプリが起動した時、THE アプリ SHALL ローカルストレージから習慣項目を読み込み、習慣リストとして表示する
2. THE アプリ SHALL 習慣リストに各習慣項目の名前と累積カウントを表示する
3. THE アプリ SHALL 習慣リストの項目数を最大10件に制限する
4. WHEN 習慣項目が0件の時、THE アプリ SHALL 空状態のメッセージを表示する

### 要件2: カウントの記録

**ユーザーストーリー:** ユーザーとして、習慣項目をタップして実行回数を記録したい。日々の積み重ねを可視化するため。

#### 受け入れ基準

1. WHEN ユーザーが習慣項目をタップした時、THE アプリ SHALL その習慣項目の累積カウントを1増加させる
2. WHEN 累積カウントが更新された時、THE アプリ SHALL 更新後のカウントを画面上に即座に反映する
3. WHEN 累積カウントが更新された時、THE アプリ SHALL 更新後の値をローカルストレージに永続化する

### 要件3: 習慣項目の作成

**ユーザーストーリー:** ユーザーとして、新しい習慣項目を追加したい。追跡したい習慣を登録するため。

#### 受け入れ基準

1. THE アプリ SHALL 画面右上に追加ボタンを配置する
2. WHEN ユーザーが追加ボタンをタップした時、THE アプリ SHALL 作成モーダルを表示する
3. WHEN ユーザーが作成モーダルで有効な習慣名を入力し保存した時、THE アプリ SHALL 新しい習慣項目を累積カウント0で作成し習慣リストに追加する
4. WHEN ユーザーが空白のみの習慣名で保存しようとした時、THE アプリ SHALL 保存を拒否しエラーメッセージを表示する
5. IF 習慣リストが既に10件に達している場合、THEN THE アプリ SHALL 追加ボタンを無効化する

### 要件4: 習慣項目の編集・削除

**ユーザーストーリー:** ユーザーとして、既存の習慣項目を編集・削除したい。習慣の内容を修正したりリストを整理するため。

#### 受け入れ基準

1. WHEN ユーザーが習慣項目を長押しした時、THE アプリ SHALL 編集モーダルを表示する
2. THE アプリ SHALL 編集モーダルに現在の習慣名をプリセットした状態で表示する
3. WHEN ユーザーが編集モーダルで有効な名前を入力し保存した時、THE アプリ SHALL 習慣項目の名前を更新し累積カウントを維持する
4. WHEN ユーザーが空白のみの名前で保存しようとした時、THE アプリ SHALL 保存を拒否しエラーメッセージを表示する
5. WHEN ユーザーが編集モーダルで削除ボタンをタップした時、THE アプリ SHALL 確認ダイアログを表示する
6. WHEN ユーザーが削除確認で承認した時、THE アプリ SHALL 習慣項目を習慣リストとローカルストレージから完全に削除する
7. WHEN ユーザーが削除確認でキャンセルした時、THE アプリ SHALL 習慣項目を変更せず編集モーダルに戻る

### 要件5: 結果の共有

**ユーザーストーリー:** ユーザーとして、習慣の達成状況を共有したい。モチベーションを維持するため。

#### 受け入れ基準

1. THE アプリ SHALL 共有ボタンを画面上に配置する
2. WHEN ユーザーが共有ボタンをタップした時、THE アプリ SHALL 全習慣項目の名前と累積カウントをテキスト形式でフォーマットする
3. WHEN 共有テキストが生成された時、THE アプリ SHALL OSネイティブの共有シートを表示する
4. WHEN 習慣項目が0件の時、THE アプリ SHALL 共有ボタンを無効化する

### 要件6: データの永続化

**ユーザーストーリー:** ユーザーとして、アプリを閉じても習慣データが保持されてほしい。継続的に記録を続けるため。

#### 受け入れ基準

1. THE アプリ SHALL 全ての習慣項目データをAsyncStorageに保存する
2. WHEN アプリが起動した時、THE アプリ SHALL AsyncStorageから習慣項目データを読み込み復元する
3. WHEN 習慣項目の作成・編集・削除・カウント更新が行われた時、THE アプリ SHALL 変更をAsyncStorageに保存する
4. IF AsyncStorageからのデータ読み込みに失敗した場合、THEN THE アプリ SHALL 空の習慣リストで起動しエラーメッセージを表示する
5. IF AsyncStorageへの保存に失敗した場合、THEN THE アプリ SHALL ユーザーにエラーメッセージを表示する
